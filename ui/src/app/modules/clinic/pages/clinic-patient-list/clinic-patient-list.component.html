<div *ngIf="{ settingCurrentLocationStatus: settingCurrentLocationStatus$ | async, consultationEncounterType: consultationEncounterType$ | async, consultationOrderType: consultationOrderType$ | async, radiologyOrderType: radiologyOrderType$ | async, drugOrderType: drugOrderType$ | async, labTestOrderType: labTestOrderType$ | async, showAllPatientsTab: showAllPatientsTab$ | async, userPrivileges: userPrivileges$ | async } as params">
  <!-- Add your existing toolbar code here -->

  <!-- New section for the patient journey dashboard -->
  <div class="dashboard-container">
    <!-- Stacked bar chart for patient journey -->
    <div style="display: block;">
      <canvas baseChart
              [datasets]="barChartData"
              [labels]="barChartLabels"
              [options]="barChartOptions"
              [legend]="barChartLegend"
              [chartType]="barChartType"
              [colors]="barChartColors"
              [plugins]="barChartPlugins">
      </canvas>
    </div>

    <!-- Patient details section -->
    <div class="patient-details-section">
      <!-- Patient list tabs -->
      <mat-tab-group
        (selectedTabChange)="changeTab(selectedTab.value)"
        [selectedIndex]="selectedTab.value"
        (selectedIndexChange)="selectedTab.setValue($event)"
      >
        <!-- Add tabs for different patient categories -->

        <!-- Awaiting Consultation tab -->
        <mat-tab label="Awaiting Consultation">
          <ng-template matTabContent>
            <app-patient-list
              [isTabularList]="true"
              [itemsPerPage]="10"
              [currentLocation]="(currentLocation$ | async)?.id"
              [orderType]="params?.consultationOrderType"
              (selectPatient)="onSelectPatient($event)"
            ></app-patient-list>
          </ng-template>
        </mat-tab>

        <!-- Attended tab -->
        <mat-tab label="Attended">
          <ng-template matTabContent>
            <app-patient-list
              [isTabularList]="true"
              [itemsPerPage]="10"
              [currentLocation]="(currentLocation$ | async)?.id"
              [orderType]="params?.consultationOrderType"
              [orderStatus]="'RECEIVED'"
              [currentLocation]="(currentLocation$ | async)?.id"
              (selectPatient)="onSelectPatient($event)"
            ></app-patient-list>
          </ng-template>
        </mat-tab>

        <!-- With Laboratory Tests tab -->
        <mat-tab label="With Laboratory Tests">
          <ng-template matTabContent>
            <app-patient-list
              [currentLocation]="(currentLocation$ | async)?.id"
              [shouldShowParentLocation]="true"
              [orderType]="params?.labTestOrderType"
              [isTabularList]="true"
              [itemsPerPage]="10"
              (selectPatient)="onSelectPatient($event)"
            ></app-patient-list>
          </ng-template>
        </mat-tab>

        <!-- With Radiology Orders tab -->
        <mat-tab label="With Radiology Orders">
          <ng-template matTabContent>
            <app-patient-list
              [shouldShowParentLocation]="true"
              [orderType]="params?.radiologyOrderType"
              [isTabularList]="true"
              [itemsPerPage]="10"
              (selectPatient)="onSelectPatient($event)"
            ></app-patient-list>
          </ng-template>
        </mat-tab>

        <!-- With Medications tab -->
        <mat-tab label="With Medications">
          <ng-template matTabContent>
            <app-patient-list
              [shouldShowParentLocation]="true"
              [orderType]="params?.drugOrderType"
              [isTabularList]="true"
              [itemsPerPage]="10"
              (selectPatient)="onSelectPatient($event)"
            ></app-patient-list>
          </ng-template>
        </mat-tab>

        <!-- Admitted Patients tab -->
        <mat-tab label="Admitted Patients">
          <ng-template matTabContent>
            <app-patient-list
              [shouldShowParentLocation]="true"
              [isTabularList]="true"
              [itemsPerPage]="10"
              [encounterType]="'e22e39fd-7db2-45e7-80f1-60fa0d5a4378'"
              (selectPatient)="onSelectPatient($event)"
            ></app-patient-list>
          </ng-template>
        </mat-tab>

        <!-- All Patients tab -->
        <mat-tab
          label="All Patients"
          *ngIf="
            params?.showAllPatientsTab?.value === 'true' &&
            (params?.userPrivileges['CLINIC_VIEW_ALL_CLIENTS'] ||
              params?.userPrivileges['ALL'])
          "
        >
          <ng-template matTabContent>
            <app-patient-list
              [shouldShowParentLocation]="true"
              [doNotUseLocation]="true"
              [isTabularList]="true"
              [itemsPerPage]="10"
              [orderType]=""
              (selectPatient)="onSelectPatient($event)"
            ></app-patient-list>
          </ng-template>
        </mat-tab>

        <!-- Every Patients History tab -->
        <mat-tab
          label="Every Patients History"
          *ngIf="
            params?.userPrivileges[
              'CLINIC_VIEW_PATIENT_HISTORY_WITHOUT_ACTIVE_VISIT'
            ] || params?.userPrivileges['ALL']
          "
        >
          <ng-template matTabContent>
            <app-patient-search
              (selectPatient)="onOpenHistory($event)"
            ></app-patient-search>
          </ng-template>
        </mat-tab>
      </mat-tab-group>
    </div>
  </div>
</div>
